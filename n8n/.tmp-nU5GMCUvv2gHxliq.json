{"updatedAt":"2026-02-04T17:50:55.778Z","createdAt":"2026-02-04T17:37:42.829Z","id":"nU5GMCUvv2gHxliq","name":"WF2 — Relecture TTS","description":null,"active":false,"isArchived":false,"nodes":[{"id":"wh-tts","name":"Webhook — Réception piece_id","type":"n8n-nodes-base.webhook","typeVersion":2,"position":[0,200],"parameters":{"httpMethod":"POST","path":"v1/tts","responseMode":"responseNode","options":{}}},{"id":"if-token-2","name":"IF — Vérification token","type":"n8n-nodes-base.if","typeVersion":2,"position":[250,200],"parameters":{"conditions":{"combinator":"and","version":1,"conditions":[{"id":"1","leftValue":"={{ $input.item.json.headers['x-api-token'] }}","operator":{"operation":"equals","type":"string"},"rightValue":"={{ $env.WEBHOOK_TOKEN }}"}]}}},{"id":"sup-get-transcriptions","name":"Supabase — Récupérer transcriptions","type":"n8n-nodes-base.supabase","typeVersion":1,"position":[500,100],"credentials":{"supabaseApi":{"name":"Supabase account"}},"parameters":{"resource":"row","operation":"getAll","tableId":"transcriptions","returnAll":true,"filterType":"string","filterString":"piece_id=eq.{{ $('Webhook — Réception piece_id').item.json.piece_id }}&order=created_at.asc"}},{"id":"code-assemble","name":"Code — Assembler texte","type":"n8n-nodes-base.code","typeVersion":2,"position":[750,100],"parameters":{"mode":"runOnceForAllItems","language":"javascript","jsCode":"const items = $input.all();\nconst text = items.map(i => i.json.text).join('. ');\nreturn [{ json: { assembled_text: text } }];"}},{"id":"http-tts","name":"HTTP Request — OpenAI TTS","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1000,100],"parameters":{"method":"POST","url":"https://api.openai.com/v1/audio/speech","sendBody":true,"contentType":"json","specifyBody":"json","jsonBody":"={{ JSON.stringify({ model: 'tts-1', input: $input.item.json.assembled_text, voice: 'alloy' }) }}","sendHeaders":true,"specifyHeaders":"keypair","headerParameters":{"parameters":[{"name":"Authorization","value":"=\"Bearer \" + $env.OPENAI_API_KEY"}]},"options":{"response":{"responseFormat":"file","outputFieldName":"data"}}}},{"id":"respond-audio","name":"Respond — Audio TTS","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1250,100],"parameters":{"respondWith":"binary","responseDataSource":"set","inputFieldName":"data","options":{"statusCode":200,"headers":{"Content-Type":"audio/mpeg"}}}},{"id":"respond-401-2","name":"Respond — Non autorisé","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[500,350],"parameters":{"respondWith":"json","responseBody":"={{ JSON.stringify({ error: 'Token invalide ou manquant' }) }}","options":{"statusCode":401}}}],"connections":{"wh-tts":{"main":[[{"node":"if-token-2","type":"main","index":0}]]},"if-token-2":{"main":[[{"node":"sup-get-transcriptions","type":"main","index":0}],[{"node":"respond-401-2","type":"main","index":0}]]},"sup-get-transcriptions":{"main":[[{"node":"code-assemble","type":"main","index":0}]]},"code-assemble":{"main":[[{"node":"http-tts","type":"main","index":0}]]},"http-tts":{"main":[[{"node":"respond-audio","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","availableInMCP":false},"staticData":null,"meta":null,"pinData":null,"versionId":"ecb6dc91-b384-4595-9356-6e0f8c10a002","activeVersionId":null,"versionCounter":2,"triggerCount":0,"shared":[{"updatedAt":"2026-02-04T17:37:42.832Z","createdAt":"2026-02-04T17:37:42.832Z","role":"workflow:owner","workflowId":"nU5GMCUvv2gHxliq","projectId":"DeS6f0Q0gHCprsDu","project":{"updatedAt":"2025-06-08T13:14:35.810Z","createdAt":"2025-06-08T13:10:46.548Z","id":"DeS6f0Q0gHCprsDu","name":"Denis Solé <s2drenovation@gmail.com>","type":"personal","icon":null,"description":null,"creatorId":"296d9a25-53e8-4c25-9c9b-2e28c6c2bd8e","projectRelations":[{"updatedAt":"2025-06-08T13:10:46.549Z","createdAt":"2025-06-08T13:10:46.549Z","userId":"296d9a25-53e8-4c25-9c9b-2e28c6c2bd8e","projectId":"DeS6f0Q0gHCprsDu","user":{"updatedAt":"2026-02-04T14:25:05.000Z","createdAt":"2025-06-08T13:10:45.952Z","id":"296d9a25-53e8-4c25-9c9b-2e28c6c2bd8e","email":"s2drenovation@gmail.com","firstName":"Denis","lastName":"Solé","personalizationAnswers":{"version":"v4","personalization_survey_submitted_at":"2025-06-08T13:16:27.629Z","personalization_survey_n8n_version":"1.90.2","companyIndustryExtended":["other"],"otherCompanyIndustryExtended":"webmaster freelance","companySize":"<20","companyType":"other","role":"business-owner","reportedSource":"youtube"},"settings":{"userActivated":true,"easyAIWorkflowOnboarded":true,"firstSuccessfulWorkflowId":"WzxEDEzeLEa8yVav","userActivatedAt":1749897086168,"npsSurvey":{"responded":true,"lastShownAt":1766508367754},"dismissedCallouts":{"aiAgentStarterCallout":true}},"disabled":false,"mfaEnabled":true,"lastActiveAt":"2026-02-04","isPending":false}}]}}],"tags":[],"activeVersion":null}